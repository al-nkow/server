!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=()=>{};var o={getUrlParamsAsObject:function(){const e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(t,n,r)=>{e[n]=r}),e},createUrlParamsString:function(e){let t="";for(let n in e)t=t?t+"&":t+"?",e[n]&&(t+=n+"="+e[n]);return t}};var c=(e,t)=>{const n=document.getElementById("productsListWrap");if(!e||!e.length)return void(n.innerHTML="По Вашему запросу ничего не найдено, попробуйте изменить параметры поиска и повторить попытку");const r=document.createDocumentFragment();e.forEach(e=>{const o=document.createElement("div");o.classList.add("col-12","col-md-6","col-lg-4");const c=[{name:"Ширина",key:"width",units:"мм"},{name:"Высота",key:"height",units:"мм"},{name:"Толщина",key:"thickness",units:"мм"},{name:"Объём",key:"volumeL",units:"л"},{name:"Объём",key:"volumeM",units:"м.куб"},{name:"Вес",key:"weight",units:"кг"},{name:"Площадь",key:"area",units:"м.кв"}].reduce((t,n)=>t+=`${e[n.key]?`<div class="col-6">${n.name}: </div><div class="col-6">${e[n.key]}${n.units}</div>`:""}`,"");o.innerHTML=`\n      <a class="product-card card mb-3" href="/prices?product=${e._id}">\n        <img class="card-img-top" src="${e.image||"images/noimg.png"}" alt="">\n        <div class="card-body">\n          <h5 class="card-title">${e.name}</h5>\n          ${e.brand?'<h6 class="card-subtitle mb-2 text-muted">'+e.brand+"</h6>":""}\n          <p class="card-text">\n            <div class="row">\n              ${c}\n            </div>\n          </p>\n          ${e.minPrice?'<p class="card-text product-card__price">Цена от '+e.minPrice+"руб.</p>":""}\n          ${e.categoryName?'<p class="card-text"><small class="text-muted">'+e.categoryName+"</small></p>":""}\n        </div>\n      <a>\n    `,t&&(n.innerHTML=""),r.appendChild(o)}),n.appendChild(r)};var a=()=>{const e=document.getElementById("searchForm"),t=document.getElementById("searchInp"),n=document.getElementById("categorySelect"),r=document.getElementById("brandSelect"),a=window.location.href.split("?")[0],i=document.getElementById("productsFiltersBlock"),s=document.getElementById("filtersAmount");let d=[],l=[];function u(){const e=o.getUrlParamsAsObject();s.innerHTML=Object.keys(e).length,e.search&&(e.search=decodeURIComponent(e.search)),e.brand&&(e.brand=decodeURIComponent(e.brand));const t=new Headers,n={method:"POST",body:JSON.stringify(e),headers:t};t.append("Content-Type","application/json"),fetch("/api/products/search",n).then(e=>e.json()).then((function(e){const t=e&&e.searchResult?e.searchResult:null;d=t,m(!0)})).catch((function(e){console.log("SEARCH ERROR:",e)}))}function m(e){(d&&d.length||e)&&(l=d&&d.length?d.splice(0,9):[],c(l,e))}function g(e,t){const n=o.getUrlParamsAsObject();n[e]=t;const r=o.createUrlParamsString(n),c=a+r;history.pushState&&window.history.pushState({path:c},"",c)}var f;n.addEventListener("change",(function(e){g("category",e.target.value),u()})),r.addEventListener("change",(function(e){g("brand",e.target.value),u()})),e.addEventListener("submit",(function(e){e.preventDefault(),g("search",t.value),u()})),function(){const e=o.getUrlParamsAsObject(),c=e.search,a=e.category,i=e.brand;c&&(t.value=decodeURIComponent(c)),i&&(r.value=decodeURIComponent(i)),a&&(n.value=a)}(),["heightFrom","heightTo","widthFrom","widthTo","thicknessFrom","thicknessTo","weightFrom","weightTo","volumeLFrom","volumeLTo","volumeMFrom","volumeMTo","areaFrom","areaTo"].forEach(e=>{document.getElementById(e).addEventListener("input",(function(t){const{value:n}=t.target,r=n.replace(/[^+\d]/g,"");t.target.value=r,g(e,r),u()}))}),f=m,window.addEventListener("scroll",(function(){const e=window.innerHeight,t=window.pageYOffset,n=document.getElementById("siteHeader"),r=document.getElementById("productsSearchBlock"),o=document.getElementById("productsListBlock");n.offsetHeight+r.offsetHeight+o.offsetHeight-(t+e)<50&&f()})),u(),["productsFiltersToggle","productsFiltersToggleHead"].forEach(e=>{document.getElementById(e).addEventListener("click",()=>{i.classList.toggle("active")})})};n(0),n(1);-1!==window.location.href.indexOf("/products")&&a(),r()}]);